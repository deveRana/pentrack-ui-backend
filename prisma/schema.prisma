// ==========================================================================================
// PENTRACK - COMPLETE PRODUCTION-READY PRISMA SCHEMA
// ==========================================================================================
// This schema follows industry best practices:
// - Proper normalization (no JSON for relational data)
// - Enums for controlled values
// - Audit trails for compliance
// - Performance indexes
// - Cascade deletes
// - Soft deletes where needed
// ==========================================================================================

// ==========================
// Generator & Datasource
// ==========================
generator client {
    provider = "prisma-client-js"
}

datasource db {
    provider = "postgresql"
    url      = env("DATABASE_URL")
}

// ==========================================================================================
// ENUMS
// ==========================================================================================

// --------------------------------------------------
// USER & AUTH ENUMS
// --------------------------------------------------

enum UserRole {
    ADMIN // super_admin in frontend (Super Admin)
    R_ADMIN // r-admin in frontend (R Admin + Pentester capabilities)
    PENTESTER // pentester in frontend (Penetration Tester)
    CLIENT // client in frontend (Client organization)
    PARTNER // partner in frontend (Partner organization)
}

enum AccountStatus {
    ACTIVE // 'active' in frontend - Account is active
    INACTIVE // 'inactive' in frontend - Account is inactive
    PENDING // Account created but not verified/activated
    SUSPENDED // Temporarily disabled by admin
    DELETED // Soft deleted
}

enum OTPType {
    LOGIN // For login authentication
    SIGNUP // For email verification during signup
    PASSWORD_RESET // For password reset (future)
}

enum OAuthProviderType {
    GOOGLE
    MICROSOFT // Future support
    GITHUB // Future support
}

// --------------------------------------------------
// PROJECT ENUMS
// --------------------------------------------------

enum ProjectStatus {
    NOT_STARTED // 'not_started' in frontend
    IN_PROGRESS // 'in_progress' in frontend
    TESTING_COMPLETE // 'testing_complete' in frontend
    REPORT_SUBMITTED // 'report_submitted' in frontend
    UNDER_REVIEW // 'Under Review' in frontend
    REWORK_NEEDED // 'rework_needed' in frontend
    COMPLETED // 'completed' in frontend
    REJECTED // 'rejected' in frontend
    OVERDUE // 'overdue' in frontend
}

enum ProjectPriority {
    LOW // 'low' in frontend
    MEDIUM // 'medium' in frontend
    HIGH // 'high' in frontend
    CRITICAL // 'critical' in frontend
}

enum ProjectActivityType {
    CREATED // Project created
    STATUS_CHANGED // Status updated
    PENTESTER_ASSIGNED // Pentester assigned to project
    PENTESTER_CHANGED // Pentester reassigned
    DEADLINE_CHANGED // Deadline modified
    SCOPE_UPDATED // Scope of work updated
    PRIORITY_CHANGED // Priority changed
    REPORT_SUBMITTED // Report submitted for review
    REPORT_APPROVED // Report approved
    REPORT_REJECTED // Report rejected
    COMMENT_ADDED // Comment added to project
    TIMELINE_UPDATED // Timeline updated
}

// --------------------------------------------------
// REPORT ENUMS
// --------------------------------------------------

enum ReportStatus {
    PENDING // Initial submission, waiting for review
    UNDER_REVIEW // Being reviewed by R-Admin
    APPROVED // Approved and published
    REJECTED // Rejected, needs rework
    RESUBMITTED // Resubmitted after rejection
}

// --------------------------------------------------
// NOTIFICATION ENUMS
// --------------------------------------------------

enum NotificationType {
    REPORT // Report-related notifications
    STATUS // Status change notifications
    PROJECT // Project-related notifications
    DEADLINE // Deadline reminders
    OVERDUE // Overdue alerts
    USER // User-related notifications
    SYSTEM // System notifications
}

enum NotificationCategory {
    PROJECT_UPDATES // Project updates and changes
    REPORT_UPDATES // Report submissions and reviews
    DEADLINE_REMINDERS // Upcoming deadlines
    STATUS_CHANGES // Status changes
    USER_ACTIONS // User actions (assignments, etc.)
    SYSTEM_ALERTS // System-level alerts
}

enum NotificationPriority {
    LOW
    NORMAL
    HIGH
    CRITICAL
}

// --------------------------------------------------
// SYSTEM LOG ENUMS
// --------------------------------------------------

enum SystemLogType {
    CREATE // Entity creation
    UPDATE // Entity update
    DELETE // Entity deletion
    AUTH // Authentication events
    REPORT // Report events
    EXPORT // Data export events
    BACKUP // Backup events
}

enum SystemLogStatus {
    SUCCESS
    FAILED
}

// ==========================================================================================
// USER & AUTH MODELS
// ==========================================================================================

// --------------------------------------------------
// USER MODEL (Base for all roles)
// --------------------------------------------------

model User {
    id    String @id @default(uuid())
    email String @unique

    // Password field (NOT USED - all auth is OTP or OAuth)
    password String? // Always NULL for this system

    // Basic Info
    firstName String
    lastName  String
    phone     String @unique // Format: +91XXXXXXXXXX

    // Role & Status
    role   UserRole
    status AccountStatus @default(PENDING)

    // Company Info (Only for R_ADMIN and PENTESTER)
    companyEmail  String? // e.g., rana@rivedix.com
    companyDomain String? // e.g., rivedix.com

    // Profile Image
    profileImage String? // S3 URL or local path

    // Email Verification
    isEmailVerified Boolean   @default(false)
    emailVerifiedAt DateTime?

    // Login Tracking
    lastLogin   DateTime?
    lastLoginIp String?

    // Timestamps
    createdAt DateTime  @default(now())
    updatedAt DateTime  @updatedAt
    deletedAt DateTime? // Soft delete

    // ============================================
    // RELATIONS
    // ============================================

    // Auth relations
    sessions       Session[]
    otpCodes       OTPCode[]
    oauthProviders OAuthProvider[]
    auditLogs      AuthAuditLog[]

    // Role-specific profile relations
    clientProfile    Client?
    partnerProfile   Partner?
    pentesterProfile Pentester?

    // Hierarchy relations (who created whom)
    createdRAdmins    User[]    @relation("AdminCreatedRAdmins")
    createdBy         User?     @relation("AdminCreatedRAdmins", fields: [createdById], references: [id])
    createdById       String?
    createdPentesters User[]    @relation("RAdminCreatedPentesters")
    createdByRAdmin   User?     @relation("RAdminCreatedPentesters", fields: [createdByRAdminId], references: [id])
    createdByRAdminId String?
    createdClients    Client[]  @relation("RAdminCreatedClients")
    createdPartners   Partner[] @relation("RAdminCreatedPartners")

    // Resource creation relations
    createdServiceCategories ServiceCategory[] @relation("RAdminCreatedServiceCategories")
    createdSubServices       SubService[]      @relation("RAdminCreatedSubServices")
    createdSecurityChecks    SecurityCheck[]   @relation("RAdminCreatedSecurityChecks")

    // Project relations
    managedProjects   Project[]         @relation("RAdminManagedProjects") // Projects managed by R-Admin
    assignedProjects  Project[]         @relation("PentesterAssignedProjects") // Projects assigned to Pentester
    projectActivities ProjectActivity[] @relation("UserProjectActivities") // Project activities by this user

    // Report relations
    submittedReports Report[] @relation("PentesterSubmittedReports")
    reviewedReports  Report[] @relation("RAdminReviewedReports")

    // Notification relations
    notifications Notification[] @relation("UserNotifications")

    @@index([email])
    @@index([role])
    @@index([status])
    @@index([companyDomain])
    @@index([phone])
    @@index([createdById])
    @@index([createdByRAdminId])
    @@map("users")
}

// --------------------------------------------------
// SESSION MODEL
// --------------------------------------------------

model Session {
    id         String   @id @default(uuid())
    userId     String
    token      String   @unique // Random secure token (stored in HTTP-only cookie)
    expiresAt  DateTime
    rememberMe Boolean  @default(false)

    // Security Tracking
    userAgent    String?  @db.Text
    ipAddress    String?
    lastActivity DateTime @default(now())

    // Device Info (for "Active Sessions" feature)
    deviceName String? // e.g., "Chrome on Windows"
    deviceType String? // e.g., "desktop", "mobile"

    // Timestamps
    createdAt DateTime @default(now())

    // Relations
    user User @relation(fields: [userId], references: [id], onDelete: Cascade)

    @@index([token])
    @@index([userId])
    @@index([expiresAt])
    @@index([userId, expiresAt])
    @@map("sessions")
}

// --------------------------------------------------
// OTP MODEL
// --------------------------------------------------

model OTPCode {
    id     String  @id @default(uuid())
    userId String? // NULL if user doesn't exist yet (signup flow)
    email  String // Email where OTP is sent
    code   String // 6-digit code (MUST be hashed before storing!)
    type   OTPType

    // Expiry & Usage
    expiresAt DateTime // Typically 10 minutes from creation
    usedAt    DateTime? // Mark as used instead of deleting (audit trail)

    // Rate Limiting Tracking
    attempts Int @default(0) // Track failed verification attempts

    // Timestamps
    createdAt DateTime @default(now())

    // Relations
    user User? @relation(fields: [userId], references: [id], onDelete: Cascade)

    @@index([email])
    @@index([email, type])
    @@index([code])
    @@index([expiresAt])
    @@index([userId])
    @@map("otp_codes")
}

// --------------------------------------------------
// OAUTH PROVIDER MODEL
// --------------------------------------------------

model OAuthProvider {
    id         String            @id @default(uuid())
    userId     String
    provider   OAuthProviderType
    providerId String // Unique ID from provider (Google's "sub" claim)

    // Profile Data from Provider
    email   String? // Email from OAuth provider
    name    String? // Full name from OAuth provider
    picture String? // Profile picture URL from OAuth provider

    // Token Storage (optional - for API calls to Google on behalf of user)
    accessToken  String?   @db.Text
    refreshToken String?   @db.Text
    expiresAt    DateTime?

    // Tracking
    linkedAt   DateTime @default(now())
    lastUsedAt DateTime @default(now())

    // Timestamps
    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt

    // Relations
    user User @relation(fields: [userId], references: [id], onDelete: Cascade)

    @@unique([userId, provider])
    @@unique([provider, providerId])
    @@index([userId])
    @@index([provider, providerId])
    @@map("oauth_providers")
}

// ==========================================================================================
// PROFILE MODELS
// ==========================================================================================

// --------------------------------------------------
// CLIENT PROFILE MODEL
// --------------------------------------------------

model Client {
    id     String @id @default(uuid())
    userId String @unique

    // Client ID (e.g., "CLI-001")
    clientId String @unique

    // Company Details
    companyName String
    industry    String
    address     String
    website     String?

    // SPOC (Single Point of Contact)
    pointOfContact      String
    pointOfContactEmail String
    pointOfContactPhone String

    // Partner Association
    hasPartner Boolean @default(false)
    partnerId  String?

    // User Type
    userType String @default("client") // 'client' or 'partner'

    // Stats (updated by triggers/application logic)
    totalProjects  Int @default(0)
    activeProjects Int @default(0)

    // Dates
    joinedDate DateTime @default(now())

    // Timestamps
    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt

    // Created By (R-Admin who created this client)
    createdById String?
    createdBy   User?   @relation("RAdminCreatedClients", fields: [createdById], references: [id])

    // Relations
    user     User      @relation(fields: [userId], references: [id], onDelete: Cascade)
    partner  Partner?  @relation("PartnerClients", fields: [partnerId], references: [id])
    projects Project[] @relation("ClientProjects")

    @@index([userId])
    @@index([companyName])
    @@index([clientId])
    @@index([partnerId])
    @@index([createdById])
    @@map("clients")
}

// --------------------------------------------------
// PARTNER PROFILE MODEL
// --------------------------------------------------

model Partner {
    id     String @id @default(uuid())
    userId String @unique

    // Company Details
    companyName String
    industry    String
    address     String
    website     String?

    // SPOC
    pointOfContact      String
    pointOfContactEmail String
    pointOfContactPhone String

    // User Type
    userType String @default("partner")

    // Stats
    totalProjects  Int @default(0)
    activeProjects Int @default(0)

    // Timestamps
    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt

    // Created By (R-Admin who created this partner)
    createdById String?
    createdBy   User?   @relation("RAdminCreatedPartners", fields: [createdById], references: [id])

    // Relations
    user     User      @relation(fields: [userId], references: [id], onDelete: Cascade)
    clients  Client[]  @relation("PartnerClients")
    projects Project[]

    @@index([userId])
    @@index([companyName])
    @@index([createdById])
    @@map("partners")
}

// --------------------------------------------------
// PENTESTER PROFILE MODEL
// --------------------------------------------------

model Pentester {
    id     String @id @default(uuid())
    userId String @unique

    // Profile Info
    specialization String
    location       String
    bio            String?  @db.Text
    memberSince    DateTime @default(now())

    // Stats (updated by triggers/application logic)
    totalProjects      Int @default(0)
    completedProjects  Int @default(0)
    inProgressProjects Int @default(0)

    // Timestamps
    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt

    // Relations
    user User @relation(fields: [userId], references: [id], onDelete: Cascade)

    @@index([userId])
    @@index([specialization])
    @@map("pentesters")
}

// ==========================================================================================
// SERVICE & CHECK MODELS
// ==========================================================================================

// --------------------------------------------------
// SERVICE CATEGORY MODEL
// --------------------------------------------------

model ServiceCategory {
    id String @id @default(uuid())

    // Basic Info
    name        String  @unique
    description String? @db.Text

    // Created By (R-Admin)
    createdById String
    createdBy   User   @relation("RAdminCreatedServiceCategories", fields: [createdById], references: [id])

    // Status
    isActive Boolean @default(true)

    // Stats (computed or updated by triggers)
    projectCount Int @default(0)

    // Timestamps
    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt

    // Relations
    subServices SubService[]
    projects    Project[]

    @@index([createdById])
    @@index([name])
    @@index([isActive])
    @@map("service_categories")
}

// --------------------------------------------------
// SUB SERVICE MODEL (Normalized - not JSON)
// --------------------------------------------------

model SubService {
    id String @id @default(uuid())

    // Service Category
    serviceCategoryId String
    serviceCategory   ServiceCategory @relation(fields: [serviceCategoryId], references: [id], onDelete: Cascade)

    // Basic Info
    name        String
    description String? @db.Text

    // Status
    isActive Boolean @default(true)

    // Created By (R-Admin)
    createdById String
    createdBy   User   @relation("RAdminCreatedSubServices", fields: [createdById], references: [id])

    // Timestamps
    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt

    @@unique([serviceCategoryId, name]) // Unique within a category
    @@index([serviceCategoryId])
    @@index([createdById])
    @@index([isActive])
    @@map("sub_services")
}

// --------------------------------------------------
// SECURITY CHECK MODEL (Check Templates)
// --------------------------------------------------

model SecurityCheck {
    id String @id @default(uuid())

    // Check Details
    title       String
    description String? @db.Text

    // Service Association
    serviceCategory String
    subService      String

    // Mandatory Flag
    isMandatory Boolean @default(false)

    // Created By (R-Admin)
    createdById String
    createdBy   User   @relation("RAdminCreatedSecurityChecks", fields: [createdById], references: [id])

    // Status
    isActive Boolean @default(true)

    // Timestamps
    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt

    // Relations
    reportChecks ReportCheck[]

    @@index([createdById])
    @@index([serviceCategory])
    @@index([subService])
    @@index([isMandatory])
    @@index([isActive])
    @@map("security_checks")
}

// ==========================================================================================
// PROJECT MODELS
// ==========================================================================================

// --------------------------------------------------
// PROJECT MODEL
// --------------------------------------------------

model Project {
    id String @id @default(uuid())

    // Basic Info
    name        String
    description String? @db.Text

    // Client & Partner
    clientId  String
    client    Client   @relation("ClientProjects", fields: [clientId], references: [id])
    partnerId String? // Optional - if referred by partner
    partner   Partner? @relation(fields: [partnerId], references: [id])

    // Management & Assignment
    radminId    String // R-Admin who manages/created this project
    radmin      User    @relation("RAdminManagedProjects", fields: [radminId], references: [id])
    pentesterId String? // Pentester assigned (can be R-Admin if they're doing the work)
    pentester   User?   @relation("PentesterAssignedProjects", fields: [pentesterId], references: [id])
    assignedBy  String? // Who assigned the pentester

    // Service
    serviceCategoryId String?
    serviceCategory   ServiceCategory? @relation(fields: [serviceCategoryId], references: [id])
    services          String[] // Array of service names (e.g., ["VAPT", "Web Application Testing"])

    // Status & Priority
    status   ProjectStatus   @default(NOT_STARTED)
    priority ProjectPriority @default(MEDIUM)

    // Dates
    startDate DateTime?
    endDate   DateTime?
    deadline  DateTime?

    // Progress
    progress Int @default(0) // 0-100

    // Scope Details
    scopeOfWork String? @db.Text
    objectives  String? @db.Text
    targetUrls  String? @db.Text

    // Metadata
    createdBy String? // Who created the project (usually R-Admin)

    // Timestamps
    createdAt DateTime  @default(now())
    updatedAt DateTime  @updatedAt
    deletedAt DateTime? // Soft delete

    // Relations
    reports       Report[]
    timelines     ProjectTimeline[]
    activities    ProjectActivity[]
    notifications Notification[]

    @@index([clientId])
    @@index([partnerId])
    @@index([radminId])
    @@index([pentesterId])
    @@index([status])
    @@index([priority])
    @@index([serviceCategoryId])
    @@index([startDate])
    @@index([endDate])
    @@index([deadline])
    @@map("projects")
}

// --------------------------------------------------
// PROJECT TIMELINE MODEL
// --------------------------------------------------

model ProjectTimeline {
    id String @id @default(uuid())

    // Project relation
    projectId String
    project   Project @relation(fields: [projectId], references: [id], onDelete: Cascade)

    // Timeline stage
    status      ProjectStatus // Use ProjectStatus enum for consistency
    date        DateTime? // When this status was reached (null if not yet reached)
    completed   Boolean       @default(false)
    description String? // Description of this stage

    // Order
    order Int @default(0) // Display order (0, 1, 2, ...)

    // Timestamps
    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt

    @@index([projectId])
    @@index([projectId, order])
    @@index([status])
    @@map("project_timelines")
}

// --------------------------------------------------
// PROJECT ACTIVITY MODEL (Audit Trail)
// --------------------------------------------------

model ProjectActivity {
    id String @id @default(uuid())

    // Project relation
    projectId String
    project   Project @relation(fields: [projectId], references: [id], onDelete: Cascade)

    // User who performed the action
    userId String
    user   User   @relation("UserProjectActivities", fields: [userId], references: [id])

    // Activity details
    activityType ProjectActivityType
    description  String              @db.Text

    // Metadata (store additional context as JSON)
    metadata Json? // e.g., {oldStatus: "IN_PROGRESS", newStatus: "COMPLETED"}

    // Timestamps
    createdAt DateTime @default(now())

    @@index([projectId])
    @@index([userId])
    @@index([activityType])
    @@index([createdAt])
    @@index([projectId, createdAt]) // Composite index for timeline queries
    @@map("project_activities")
}

// ==========================================================================================
// REPORT MODELS
// ==========================================================================================

// --------------------------------------------------
// REPORT MODEL
// --------------------------------------------------

model Report {
    id String @id @default(uuid())

    // Project & User Relations
    projectId   String
    project     Project @relation(fields: [projectId], references: [id])
    pentesterId String // Who submitted
    pentester   User    @relation("PentesterSubmittedReports", fields: [pentesterId], references: [id])
    reviewerId  String? // R-Admin who reviews
    reviewer    User?   @relation("RAdminReviewedReports", fields: [reviewerId], references: [id])

    // Version Tracking
    version Int @default(1)

    // File Info
    fileName String
    fileUrl  String
    fileSize Int // in bytes
    fileType String // e.g., "application/pdf"

    // Status
    status ReportStatus @default(PENDING)

    // Submission Details
    submissionNotes String? @db.Text

    // Review Details
    reviewedAt      DateTime?
    reviewNotes     String?   @db.Text // Approval notes
    rejectionReason String?   @db.Text

    // Timestamps
    submittedAt DateTime @default(now())
    createdAt   DateTime @default(now())
    updatedAt   DateTime @updatedAt

    // Relations
    history ReportHistory[]
    checks  ReportCheck[]

    @@index([projectId])
    @@index([pentesterId])
    @@index([reviewerId])
    @@index([status])
    @@index([version])
    @@index([submittedAt])
    @@map("reports")
}

// --------------------------------------------------
// REPORT HISTORY MODEL
// --------------------------------------------------

model ReportHistory {
    id String @id @default(uuid())

    // Report relation
    reportId String
    report   Report @relation(fields: [reportId], references: [id], onDelete: Cascade)

    // Version info
    version Int
    status  ReportStatus

    // Dates
    submittedDate DateTime
    reviewedDate  DateTime?

    // File info
    fileName String
    fileUrl  String

    // Review details
    approvalNotes   String? @db.Text
    rejectionReason String? @db.Text

    // Timestamps
    createdAt DateTime @default(now())

    @@index([reportId])
    @@index([reportId, version])
    @@index([status])
    @@map("report_histories")
}

// --------------------------------------------------
// REPORT CHECK MODEL (Normalized - not JSON)
// --------------------------------------------------

model ReportCheck {
    id String @id @default(uuid())

    // Report relation
    reportId String
    report   Report @relation(fields: [reportId], references: [id], onDelete: Cascade)

    // Security check template relation
    securityCheckId String
    securityCheck   SecurityCheck @relation(fields: [securityCheckId], references: [id])

    // Completion status
    completed Boolean @default(false)
    notes     String? @db.Text

    // Timestamps
    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt

    @@unique([reportId, securityCheckId]) // Can't have duplicate checks per report
    @@index([reportId])
    @@index([securityCheckId])
    @@index([completed])
    @@map("report_checks")
}

// ==========================================================================================
// NOTIFICATION MODEL
// ==========================================================================================

model Notification {
    id String @id @default(uuid())

    // Recipient
    userId String
    user   User   @relation("UserNotifications", fields: [userId], references: [id], onDelete: Cascade)

    // Notification Details
    type     NotificationType
    category NotificationCategory
    priority NotificationPriority @default(NORMAL)
    title    String
    message  String               @db.Text
    link     String? // Optional link to relevant page

    // Read Status
    read   Boolean   @default(false)
    readAt DateTime?

    // Related Entities
    projectId String?
    project   Project? @relation(fields: [projectId], references: [id])

    // Timestamps
    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt

    @@index([userId])
    @@index([userId, read])
    @@index([type])
    @@index([category])
    @@index([priority])
    @@index([createdAt])
    @@index([projectId])
    @@map("notifications")
}

// ==========================================================================================
// SYSTEM & AUDIT MODELS
// ==========================================================================================

// --------------------------------------------------
// AUTH AUDIT LOG MODEL (System Logs)
// --------------------------------------------------

model AuthAuditLog {
    id     String  @id @default(uuid())
    userId String?

    // Event Info
    event       String // "LOGIN_SUCCESS", "LOGIN_FAILED", "OTP_SENT", etc.
    eventType   SystemLogType // Enum type for filtering
    description String?       @db.Text

    // Status
    status SystemLogStatus @default(SUCCESS)

    // Metadata
    metadata Json? // Additional data

    // Tracking
    ipAddress String?
    userAgent String? @db.Text

    // Timestamps
    createdAt DateTime @default(now())

    // Relations
    user User? @relation(fields: [userId], references: [id])

    @@index([userId])
    @@index([event])
    @@index([eventType])
    @@index([status])
    @@index([createdAt])
    @@index([eventType, status]) // Composite index for filtered queries
    @@map("auth_audit_logs")
}

// --------------------------------------------------
// ACCOUNT INVITATION MODEL
// --------------------------------------------------

model AccountInvitation {
    id        String   @id @default(uuid())
    email     String
    role      UserRole
    invitedBy String // User ID of who sent the invite

    token     String   @unique // Unique token for invitation link
    expiresAt DateTime

    // Status
    status     String    @default("PENDING") // PENDING, ACCEPTED, EXPIRED
    acceptedAt DateTime?

    // Metadata
    metadata Json? // Store additional data (e.g., company info for pentester)

    // Timestamps
    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt

    @@index([email])
    @@index([token])
    @@index([status])
    @@index([expiresAt])
    @@index([role])
    @@map("account_invitations")
}

// ==========================================================================================
// END OF SCHEMA
// ==========================================================================================
// 
// TOTAL MODELS: 21
// - User & Auth: User, Session, OTPCode, OAuthProvider (4)
// - Profiles: Client, Partner, Pentester (3)
// - Services: ServiceCategory, SubService, SecurityCheck (3)
// - Projects: Project, ProjectTimeline, ProjectActivity (3)
// - Reports: Report, ReportHistory, ReportCheck (3)
// - Notifications: Notification (1)
// - System: AuthAuditLog, AccountInvitation (2)
// - Partner Relations: PartnerClients (implicit join table) (1)
//
// TOTAL ENUMS: 11
// - UserRole, AccountStatus, OTPType, OAuthProviderType
// - ProjectStatus, ProjectPriority, ProjectActivityType
// - ReportStatus
// - NotificationType, NotificationCategory, NotificationPriority
// - SystemLogType, SystemLogStatus
//
// ==========================================================================================
